#!/usr/bin/env php
<?php

use SPSOstrov\Runtime\RuntimeConfig;
use SPSOstrov\Runtime\Path;

if (!isset($_composer_autoload_path)) {
    fprintf(STDERR, "Error: Cannot run app directly, use only as a dependency.\n");
    exit(1);
}
include $_composer_autoload_path;
$rootDir = dirname(Path::canonize(dirname($_composer_autoload_path)));
$config = (new RuntimeConfig($rootDir))->get();
putenv("APP_DIR=" . $rootDir);
putenv("APP_BIN=" . Path::canonize($rootDir . "/vendor/bin/app"));

echo "APP!\n";
var_dump($config, $argv);
system("env");
